<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>霓虹牌 - Neon Card Game</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/theme.js"></script>
</head>

<body>
    <!-- Theme Toggle Removed -->

    <div class="menu-container">
        <h1 class="game-title neon-text">霓虹牌</h1>
        <div class="menu-buttons">
            <button class="btn menu-btn" onclick="showModeSelection()">開始遊戲</button>
            <button class="btn menu-btn btn-magenta" onclick="location.href='tutorial.html'">新手教學</button>
            <button class="btn menu-btn btn-primary" onclick="location.href='story_menu.html'">劇情模式</button>
            <button class="btn menu-btn btn-gold" onclick="location.href='characters.html'">角色列表</button>
            <!-- 攻略專區 (Strategy Zone) Add Here -->
            <button class="btn menu-btn" style="border-color: #00f3ff; color: #00f3ff;"
                onclick="location.href='strategy.html'">攻略專區</button>
            <button class="btn menu-btn" style="border-color: var(--neon-green); color: var(--neon-green);"
                onclick="showUpdateModal()">版本更新</button>
        </div>
    </div>

    <!-- Mode Selection Modal -->
    <div class="modal-overlay" id="modeModal">
        <div class="modal glass">
            <h2 id="modeModalTitle">選擇對戰模式</h2>

            <div class="modal-buttons" id="mainModeContainer">
                <button class="btn btn-primary" onclick="showSubMenu('pve')">單人模式 (對戰電腦)</button>
                <button class="btn btn-magenta" onclick="showSubMenu('pvp')">雙人對戰 (本地)</button>
                <button class="btn" disabled>連線模式 (開發中)</button>
                <button class="btn" onclick="closeModeModal()" style="margin-top: 20px; opacity: 0.7;">返回</button>
            </div>

            <div class="modal-buttons hidden" id="pveTypeContainer">
                <button class="btn" onclick="selectPvEType('quick')">快速模式 (3張牌)</button>
                <button class="btn btn-magenta" onclick="selectPvEType('classic')">經典模式 (7張牌)</button>
                <button class="btn" onclick="showSubMenu('main')" style="margin-top: 20px; opacity: 0.7;">返回</button>
            </div>

            <div class="modal-buttons hidden" id="pveDiffContainer">
                <button class="btn" onclick="startGame(selectedPvEType, 'pve', 'easy')">簡單</button>
                <button class="btn btn-danger" onclick="startGame(selectedPvEType, 'pve', 'hard')">困難</button>
                <button class="btn btn-magenta" onclick="startGame(selectedPvEType, 'pve', 'hell')">地獄</button>
                <button class="btn" onclick="showSubMenu('pve')" style="margin-top: 20px; opacity: 0.7;">返回</button>
            </div>

            <div class="modal-buttons hidden" id="pvpTypeContainer">
                <button class="btn" onclick="startGame('quick', 'pvp')">快速模式 (3張牌)</button>
                <button class="btn btn-magenta" onclick="startGame('classic', 'pvp')">經典模式 (7張牌)</button>
                <button class="btn" onclick="showSubMenu('main')" style="margin-top: 20px; opacity: 0.7;">返回</button>
            </div>
        </div>
    </div>

    <!-- Tutorial Overlay -->
    <div class="tutorial-overlay hidden" id="tutorialOverlay">
        <div class="tutorial-box glass">
            <h2 class="tutorial-title" id="tutorialTitle">歡迎來到霓虹牌！</h2>
            <p class="tutorial-text" id="tutorialText">這是一款對戰卡牌遊戲。讓我們開始學習基本規則吧！</p>
            <div class="tutorial-buttons">
                <button class="btn" id="tutorialPrev" onclick="prevTutorial()">上一步</button>
                <button class="btn btn-magenta" id="tutorialNext" onclick="nextTutorial()">下一步</button>
            </div>
        </div>
    </div>

    <!-- Update Modal -->
    <div class="modal-overlay" id="updateModal">
        <div class="modal glass"
            style="max-width: 800px; max-height: 80vh; text-align: left; display: flex; flex-direction: column;">
            <h2 style="text-align: center; margin-bottom: 20px;">v1.2.0 大型內容擴展與平衡性更新</h2>
            <div class="update-content"
                style="color: var(--text-primary); line-height: 1.6; overflow-y: auto; padding-right: 15px; font-size: 1.1rem;">

                <h3 style="color: var(--neon-cyan); margin-top: 10px; margin-bottom: 10px;">🌟 重磅更新：新增 107 名全新角色</h3>
                <ul
                    style="margin-left: 20px; margin-bottom: 20px; list-style-type: square; color: var(--text-secondary);">
                    <li>一口氣實裝了圖鑑編號 <strong>199 至 305</strong> 的所有全新角色！</li>
                    <li>新增多種全新戰鬥機制：包含<strong>資源累積與消耗現象</strong>、<strong>備戰區組合技（機甲合體等）</strong>。</li>
                    <li>新增多樣強力異常狀態：如<strong>黑洞吞噬、致盲、衰減護盾、過敏、催眠與侵蝕</strong>。</li>
                    <li>實裝全新技能類型：包含<strong>斬殺判定、攻擊力翻倍、吸血、反傷、犧牲血量重擊</strong>等豐富多變的戰術選擇。</li>
                </ul>

                <h3 style="color: var(--neon-green); margin-top: 10px; margin-bottom: 10px;">🟢 v1.1.0 增強角色 (Buffs)</h3>
                <ul
                    style="margin-left: 20px; margin-bottom: 20px; list-style-type: square; color: var(--text-secondary);">
                    <li><strong style="color: var(--text-primary);">迪斯查</strong>：體質增強，基礎生命值提升 (1 -> 50)，技能「免疫」敘述更清晰。
                    </li>
                    <li><strong style="color: var(--text-primary);">蘇賽德</strong>：技能「全員玉碎」傷害大幅提升 (30 -> 50)。</li>
                    <li><strong style="color: var(--text-primary);">廚師</strong>：體質增強，基礎生命值提升 (150 -> 200)。</li>
                    <li><strong style="color: var(--text-primary);">英國紳士</strong>：體質大增，基礎生命值 (80 -> 180) 與攻擊力 (10 ->
                        35)，站場能力大幅強化。</li>
                    <li><strong style="color: var(--text-primary);">鳳凰</strong>：由於浴火重生特性，基礎生命值提升 (100 -> 150)。</li>
                    <li><strong style="color: var(--text-primary);">大吉</strong>：祈福靈驗，新增強力技能「大吉領紅茶」(抽出三張紅茶牌)。</li>
                    <li><strong style="color: var(--text-primary);">12了</strong>：體質增強，基礎生命值提升 (12 -> 80)。</li>
                    <li><strong style="color: var(--text-primary);">拳</strong>：超拳技能與被動爆擊倍率大幅強化 (1.3倍)。</li>
                    <li><strong style="color: var(--text-primary);">草東街</strong>：體質增強，基礎生命值提升 (150 -> 200)。</li>
                    <li><strong style="color: var(--text-primary);">婕媞</strong>：主力技能「顆秒」冷卻時間移除 (1 -> 0)。</li>
                    <li><strong style="color: var(--text-primary);">王欸等</strong>：技能「大跳」新增增加攻擊力效果。</li>
                    <li><strong style="color: var(--text-primary);">比二蓋紙</strong>：成為大富翁，基礎生命值提升 (200 -> 250)，被動發動次數增加至 3
                        次。</li>
                    <li><strong style="color: var(--text-primary);">摳P</strong>：被動「垃圾不分藍綠」重製，現在每次施放技能後會增加少量攻擊力。</li>
                    <li><strong style="color: var(--text-primary);">可疑草叢</strong>：太可疑了，新增保命與拖延技能「我很可疑」(暈眩自己兩回合)。</li>
                    <li><strong style="color: var(--text-primary);">李白 / 李太白</strong>：傳奇詩人體質雙雙加強，基礎生命值提升 (400 ->
                        600)，李白本身攻擊力提升 (30 -> 50)。</li>
                    <li><strong style="color: var(--text-primary);">很亮的魚</strong>：體質增強，基礎生命值提升 (250 -> 300)。</li>
                </ul>

                <h3 style="color: var(--neon-pink); margin-top: 20px; margin-bottom: 10px;">🔴 削弱角色 (Nerfs)</h3>
                <ul
                    style="margin-left: 20px; margin-bottom: 20px; list-style-type: square; color: var(--text-secondary);">
                    <li><strong style="color: var(--text-primary);">超級坦克</strong>：過於強勢，技能「裝甲」增加 1 回合冷卻時間。</li>
                    <li><strong style="color: var(--text-primary);">美秀吉團</strong>：被動「大老婆」限制整場戰鬥觸發次數為 1 次。</li>
                    <li><strong style="color: var(--text-primary);">阿共</strong>：被動「共機擾台」復活機率限制為 1 次。</li>
                    <li><strong style="color: var(--text-primary);">Peter</strong>：「一階」與「二階」招式冷卻時間增加，延長進化所需時間。</li>
                    <li><strong style="color: var(--text-primary);">怕瘦團</strong>：被動「大寶」恢復血量減少 (50 -> 30)。</li>
                    <li><strong style="color: var(--text-primary);">賈伯斯max</strong>：體質大砍，基礎生命值 (570 -> 400) 與攻擊力 (70 ->
                        50) 下降。</li>
                    <li><strong style="color: var(--text-primary);">賴韋禎</strong>：被動「🤚」過於靈活，閃避機率下調 (60% -> 35%)。</li>
                </ul>

                <h3 style="color: var(--neon-cyan); margin-top: 20px; margin-bottom: 10px;">⚡ 平衡性調整 (Adjustments)</h3>
                <ul
                    style="margin-left: 20px; margin-bottom: 20px; list-style-type: square; color: var(--text-secondary);">
                    <li><strong style="color: var(--text-primary);">護理師</strong>：攻擊力適度下調 (30 -> 20)，但技能「砍一刀」傷害提升 (10 ->
                        30)。</li>
                    <li><strong style="color: var(--text-primary);">瘋狗騎士</strong>：基礎生命值下調 (500 -> 400)，但攻擊力提升 (5 ->
                        20)。同時調整技能冷卻時間與相關倍率。</li>
                    <li><strong style="color: var(--text-primary);">抽卡時間</strong>：基礎生命值提升 (200 -> 230)，但移除了副作用技能「賣血時間」。
                    </li>
                    <li><strong style="color: var(--text-primary);">拳王</strong>：被動文字說明更新與效果標準化，爆擊倍率為2.0倍。</li>
                    <li><strong style="color: var(--text-primary);">Ray生我夢</strong>：基礎生命值提升 (320 ->
                        400)，一二技能的冷卻時間與強大負面效果做了相對應的平衡。</li>
                    <li><strong style="color: var(--text-primary);">王世堅情</strong>：被動「有出息」大幅重製，現在低於 20% 血量時可以刷新所有技能一次。
                    </li>
                </ul>

                <h3 style="color: var(--neon-gold); margin-top: 20px; margin-bottom: 10px;">🛠️ 系統與遊戲調整 (System Updates)
                </h3>
                <ul
                    style="margin-left: 20px; margin-bottom: 20px; list-style-type: square; color: var(--text-secondary);">
                    <li>全面實裝了包含 32 名角色的第一波大型平衡性更新。</li>
                    <li>新增全新<strong>單人對戰模式 (PvE)</strong>，隨時可以找電腦進行卡牌對決。</li>
                    <li>實裝「<strong>AI 難度差異系統</strong>」。現在困難模式的 NPC 將懂得：優先施放技能自保、殘血時主動撤退換健康隊友、以及陣亡換人時會挑選最強角色上場。</li>
                    <li>新增對戰中電腦思考時的「思考中...」特效。</li>
                    <li>修復了多樣技能描述與實際發動效果不一致的問題。</li>
                    <li>針對多項強大被動技能加上「觸發次數限制」，防止無限循環發生。</li>
                </ul>
            </div>
            <div style="margin-top: 20px; display: flex; justify-content: center;">
                <button class="btn" style="border-color: var(--neon-green); color: var(--neon-green);"
                    onclick="closeUpdateModal()">了解！</button>
            </div>
        </div>
    </div>

    <script>
        let selectedPvEType = 'classic';

        function showModeSelection() {
            showSubMenu('main');
            document.getElementById('modeModal').classList.add('active');
        }

        function showSubMenu(menu) {
            document.getElementById('mainModeContainer').classList.add('hidden');
            document.getElementById('pveTypeContainer').classList.add('hidden');
            document.getElementById('pveDiffContainer').classList.add('hidden');
            document.getElementById('pvpTypeContainer').classList.add('hidden');

            if (menu === 'main') {
                document.getElementById('modeModalTitle').textContent = '選擇對戰模式';
                document.getElementById('mainModeContainer').classList.remove('hidden');
            } else if (menu === 'pve') {
                document.getElementById('modeModalTitle').textContent = '單人模式 - 選擇規則';
                document.getElementById('pveTypeContainer').classList.remove('hidden');
            } else if (menu === 'pvp') {
                document.getElementById('modeModalTitle').textContent = '雙人對戰 - 選擇規則';
                document.getElementById('pvpTypeContainer').classList.remove('hidden');
            }
        }

        function selectPvEType(type) {
            selectedPvEType = type;
            document.getElementById('pveTypeContainer').classList.add('hidden');
            document.getElementById('pveDiffContainer').classList.remove('hidden');
            document.getElementById('modeModalTitle').textContent = '單人模式 - 選擇難度';
        }

        function closeModeModal() {
            document.getElementById('modeModal').classList.remove('active');
        }

        function showUpdateModal() {
            document.getElementById('updateModal').classList.add('active');
        }

        function closeUpdateModal() {
            document.getElementById('updateModal').classList.remove('active');
        }

        function startGame(mode, type = 'pvp', difficulty = 'normal') {
            localStorage.setItem('gameMode', mode);
            localStorage.setItem('gameType', type);
            localStorage.setItem('pveDifficulty', difficulty);
            location.href = 'game.html';
        }

        // Tutorial System
        const tutorialSteps = [
            { title: '歡迎來到霓虹牌！', text: '這是一款雙人對戰卡牌遊戲，兩位玩家在同一台裝置上進行對戰。' },
            { title: '遊戲模式', text: '快速模式：每位玩家擁有3張牌\n經典模式：每位玩家擁有7張牌\n規則相同，只有牌數不同。' },
            { title: '開局流程', text: '1. 擲硬幣決定先手\n2. 雙方抽取角色牌\n3. 選擇一張放入戰鬥區\n4. 其餘放入備戰區' },
            { title: '戰鬥區與備戰區', text: '戰鬥區：進行戰鬥的角色（各1隻）\n備戰區：待命的角色，可透過「撤退」替換' },
            { title: '回合行動', text: '每回合必須選擇以下其中一個行動：\n• 普攻：造成ATK值的傷害\n• 技能：使用角色技能（有冷卻）\n• 撤退：與備戰區角色交換' },
            { title: '技能冷卻', text: '技能括號中的數字代表冷卻回合數。\n使用後需等待該回合數才能再次使用。\n注意：備戰區角色的冷卻也會持續計算！' },
            { title: '狀態效果', text: '• 睡眠：無法行動，每回合50%機率甦醒\n• 暈眩：無法行動\n• 中毒/灼燒：每回合受到持續傷害\n• 沉默：無法使用技能' },
            { title: '勝利條件', text: '擊敗對手所有角色即可獲勝！\n善用角色特性和技能組合來取得優勢。' },
            { title: '準備好了嗎？', text: '現在你已經了解基本規則，開始遊戲吧！\n祝你遊戲愉快！' }
        ];
        let currentStep = 0;

        function startTutorial() {
            currentStep = 0;
            document.getElementById('tutorialOverlay').classList.remove('hidden');
            updateTutorial();
        }

        function updateTutorial() {
            const step = tutorialSteps[currentStep];
            document.getElementById('tutorialTitle').textContent = step.title;
            document.getElementById('tutorialText').textContent = step.text;
            document.getElementById('tutorialPrev').style.display = currentStep === 0 ? 'none' : 'inline-block';
            document.getElementById('tutorialNext').textContent = currentStep === tutorialSteps.length - 1 ? '完成' : '下一步';
        }

        function nextTutorial() {
            if (currentStep < tutorialSteps.length - 1) {
                currentStep++;
                updateTutorial();
            } else {
                document.getElementById('tutorialOverlay').classList.add('hidden');
            }
        }

        function prevTutorial() {
            if (currentStep > 0) {
                currentStep--;
                updateTutorial();
            }
        }

        // Close modals on outside click
        document.getElementById('modeModal').addEventListener('click', function (e) {
            if (e.target === this) closeModeModal();
        });
        document.getElementById('updateModal').addEventListener('click', function (e) {
            if (e.target === this) closeUpdateModal();
        });
    </script>
</body>

</html>